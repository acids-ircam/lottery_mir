#!/bin/bash
#SBATCH --gres=gpu:1        # Request GPU generic resources
#SBATCH --cpus-per-task=16   # Cores proportional to GPUs: 6 on Cedar, 16 on Graham.
#SBATCH --mem=64000M         # Memory proportional to GPUs: 32000 Cedar, 64000 Graham.
#SBATCH --time=0-11:59
#SBATCH --output=output/out_25

module load python/3.7
virtualenv --no-download $SLURM_TMPDIR/env
source $SLURM_TMPDIR/env/bin/activate
pip install --no-index --upgrade pip
pip install --no-index -r requirements.txt
cd $SLURM_TMPDIR

cd /scratch/esling/lottery/
python main.py --device cuda --datadir /scratch/esling/datasets/ --output /scratch/esling/output/ --dataset mnist --model  --prune_scope global --prune masking --prune_percent 20 --prune_selection information --prune_reset rewind --warm_latent 100 --prune_it 15 --channels 64 --kernel 5 --n_layers 4 --epochs 200 --encoder_dims 16 --rewind_it 1 --eval_interval 25 --n_hidden 512 --k_run 0
